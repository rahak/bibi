// ================================================================================
// + Notifier
// --------------------------------------------------------------------------------


div#bibi-notifier {
	box-sizing: border-box;
	position: absolute;
	z-index: $GLOBAL__Notifier_ZIndex;
	top: 0;
	padding: 0 8px;
	@include size(100%, $GLOBAL__TopBar_Height);
	color: rgb(69,69,69);
	background: rgba(252,252,252,0.96);
	box-shadow: 0 2px 4px rgba(0,0,0,0.125);
	transition: .15s linear;
	transform-origin: 50% 0;
	p {
		text-align: center;
		font-size: 12px;
		font-weight: bold;
		line-height: ($GLOBAL__Icon_Size + $GLOBAL__ButtonGroup_Margin * 2) * 1.05;
		&.error {
			color: rgb(192,64,0);
		}
		small {
			font-size: 0.875em;
		}
	}
	& {
		opacity: 0;
		transform: translateY(-100%);//scaleY(0);
		transition: .2s linear;
	}
	html.notifier-shown & {
		opacity: 1;
		transform: none;
		transition: .15s linear;
	}
}




// ================================================================================
// + Veil
// --------------------------------------------------------------------------------


div#bibi-veil {
	box-sizing: border-box;
	overflow: hidden;
	display: block;
	position: absolute;
	z-index: $GLOBAL__Veil_ZIndex;
	left: 0;
	top: 0;
	@include size(100%);
	font-size: 15px;
	color: white;
	background: $GLOBAL__Veil_Background;
	opacity: 1;
	transition: ease-in .5s;
	&.closed {
		opacity: 0;
		transition: ease-out .5s;
		html.appearance-ltr & { transform: translateX(-240%); }
		html.appearance-rtl & { transform: translateX( 240%); }
		html.appearance-ttb & { transform: translateY(-240%); }
	}
}


// - BottomBar
// --------------------------------------------------------------------------------

div#bibi-veil:after {
	content: "";
	box-sizing: border-box;
	display: block;
	position: absolute;
	z-index: $GLOBAL__Veil-BottomBar_ZIndex;
	left: 0; right: 0; bottom: 0;
	margin: 0 auto;
	padding: 4px;
	border-style: solid; border-width: 1px 0;
	@include size(100%, $GLOBAL__BottomBar_Height);
	border-color: transparent;//rgb(104,104,104);
	background: rgb(128,128,128);
}


// - ByeBye
// --------------------------------------------------------------------------------

p#bibi-veil-byebye {
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	box-sizing: border-box;
	position: absolute;
	z-index: $GLOBAL__Veil-ByeBye_ZIndex;
	@include trbl(0);
	margin: auto;
	padding: 10px;
	border-radius: 20px;
	@include size(240px);
	@include max-size(calc(100% - #{ 10px * 2 }), calc(100% - #{ $GLOBAL__TopBar_Height + 10px * 2 + $GLOBAL__BottomBar_Height }));
	line-height: 1.75;
	text-align: center;
	font-size: 14px;
	font-weight: bold;
	color: white;
	background: rgba(black, .125);
	a {
		color: inherit;
		transition: .2s linear;
		&:hover {
			color: rgb(216,216,216);
			transition: .1s linear;
		}
	}
	span {
		display: block;
		position: relative;
	}
	> span + span {
		margin-top: 1.5em;
		padding-top: 1.5em;
		&:before {
			content: "";
			display: block;
			position: absolute;
			@include trbl(0, 0, auto);
			margin: auto;
			@include size(2em, 1px);
			background: rgba(white, .5);
		}
	}
}


// - Cover
// --------------------------------------------------------------------------------

div#bibi-veil-cover {
	& {
		overflow: hidden;
		position: absolute;
		z-index: $GLOBAL__Veil-Cover_ZIndex;
		left: 0;
		top: 0;
		box-sizing: border-box;
		border: solid transparent;
		border-width: 4px;
		//border-bottom-width: ($GLOBAL__TopBar_Height + 4px);
		@include size(100%);
		opacity: 0;
		transition: opacity 0.5s linear;
		background: transparent no-repeat center center;
		background-size: contain;
	}
	&.with-cover-image,
	&.without-cover-image {
		opacity: 1;
	}
	&.with-cover-image {
		p {
			opacity: 0;
		}/*
		p {
			overflow: hidden;
			@include size(0);
		}
		figure {
			@include size(100%);
			img {
				display: block;
				margin: auto;
				@include max-size(100%);
			}
		}*/
	}
	&.without-cover-image {
		$Veil-Cover-Icon_Size: 144px;
		p {
			z-index: 2;
			@include size(100%, 1.2em);
			line-height: 1.2;
			font-size: 14px;
			font-weight: bold;
			color: white;
			text-align: center;
			text-shadow: 0 0 4px rgb(128,128,128);
			transform: translateY($Veil-Cover-Icon_Size * -0.1);
			strong, em, small, span {
				display: block;
			}
			strong {
				margin-top: -1em;
				font-size: 1em * 18/14;
				font-weight: bold;
			}
			em {
				margin-top: .75em;
				font-size: 1em * 14/14;
			}
			small {
				margin-top: .75em;
				font-size: 1em * 12/14;
			}
			span {
				margin-top: .75em;
				font-size: 1em * 10/14;
			}
		}
		.book-icon {
			@include book-icon($Veil-Cover-Icon_Size, white, rgb(136,136,136));
			z-index: 1;
			transform: translateY($Veil-Cover-Icon_Size * -0.125);
			opacity: .25;
		}
		p,
		.book-icon {
			display: block;
			position: absolute;
			margin: auto;
			@include trbl(-100%);
		}/*
		figure {
			display: none;
		}*/
	}
	&.without-cover-image.waiting-for-unzipping {
		p {
			strong {
				font-size: 1em * 24/14;
			}
			small {
				color: rgb(216,216,216);
			}
		}
	}
}


// - Play
// --------------------------------------------------------------------------------

$Veil-Play-Icon_Size: 96px;
$Veil-Play-Icon_Offset: 8px;

$Veil-Play_TransitionDuration: .2s;
$Veil-Play_TransitionTimingFunction__ForColor: ease;
$Veil-Play_TransitionTimingFunction__ForForm: cubic-bezier(.2,.8,.8,1.6);

p#bibi-veil-play {
	display: none; html.waiting & { display: block; }
	box-sizing: border-box;
	position: absolute; @include trbl(0); margin: auto;
	z-index: $GLOBAL__Veil-Play_ZIndex;
	@include size(100%);
	cursor: pointer;
	background: rgba(black, 0);
	&, &:before {
		transition:
			color $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForColor,
			background-color $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForColor,
			left $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForForm,
			right $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForForm,
			bottom $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForForm,
			transform $Veil-Play_TransitionDuration $Veil-Play_TransitionTimingFunction__ForForm;
	}
	&:before { // icon
		@include font-icon("Material Icons");
		content: "\e038"; // play_circle_filled color: white;
		box-sizing: border-box;
		display: block;
		z-index: 10;
		position: absolute;
		margin: auto;
		//border-radius: 50%;
		@include size($Veil-Play-Icon_Size);
		line-height: $Veil-Play-Icon_Size * 0.98;
		text-align: center;
		vertical-align: middle;
		text-indent: -.05em;
		font-size: $Veil-Play-Icon_Size;
		color: rgba(236,236,236, 0.9);
		//text-shadow: 0 0 4px rgb(160,160,160)
		//color: rgb(69,69,69);
		//background: rgba(236,236,236, 0.9);
	}
	&:hover {
		background: rgba(black, 0.4);
	}
	&,
	html.appearance-ttb & { // ↓
		&:before        { transform: translateY(  0 ) scale(1.0) rotate(90deg);  @include trbl(auto, 0, $Veil-Play-Icon_Offset, 0); }
		&:hover:before  { transform: translateY( -5%) scale(1.1) rotate(90deg); }
		&:active:before { transform: translateY( 10%) scale(1.1) rotate(90deg); }
	}
	html.appearance-rtl & { // ←
		&:before        { transform: translateX(  0 ) scale(1.0) rotate(180deg);  @include trbl(0, auto, 0, $Veil-Play-Icon_Offset); }
		&:hover:before  { transform: translateX(  5%) scale(1.1) rotate(180deg); }
		&:active:before { transform: translateX(-10%) scale(1.1) rotate(180deg); }
	}
	html.appearance-ltr & { // →
		&:before        { transform: translateX(  0 ) scale(1.0) rotate(  0   );  @include trbl(0, $Veil-Play-Icon_Offset, 0, auto); }
		&:hover:before  { transform: translateX( -5%) scale(1.1) rotate(  0   ); }
		&:active:before { transform: translateX( 10%) scale(1.1) rotate(  0   ); }
	}
}


// - Catcher
// --------------------------------------------------------------------------------

$Catcher-Icon_Size: 128px;
$Catcher-CenterLine_Bottom: 56%;
$Catcher-Area_Margin: 24px;
$Catcher-Area_Narrow_Margin: $Catcher-Area_Margin * 0.5;
$Catcher_Transition: .2s ease;
$Catcher-Icon_Transition: .125s cubic-bezier(.2,.8,.8,1.6);

div#bibi-catcher {
	display: none; html.waiting-file & { display: block; }
	position: absolute;
	z-index: $GLOBAL__Catcher_ZIndex;
	@include trbl(0);
	margin: 0;
	@include size(100%);
	color: white;
	cursor: pointer;
	transition: $Catcher_Transition;
	> .pgroup {
		box-sizing: border-box;
		position: absolute;
		z-index: 100;
		@include trbl(100% - $Catcher-CenterLine_Bottom, 0, auto);
		margin: 0 auto;
		width: 100%;
		vertical-align: middle;
		text-align: center;
		display: flex;
		flex-direction: column;
		justify-content: flex-start;
		align-items: center;
		p {
			strong, em, span, small {
				display: block;
				font-weight: bold;
				transition: $Catcher_Transition;
			}
			strong {
				box-sizing: border-box;
				margin-top: 18px;
				padding: 0 1em;
				border: solid 1px white;
				height: 2.5em;
				line-height: 2.5em;
				border-radius: 1.25em;
				font-size: 16px;
				background: rgba(white, 0);
			}
			em, span, small {
				text-shadow: rgb(64,64,64) 0 0 1px;
			}
			em {
				margin-top: 14px;
				font-size: 16px;
				line-height: 1.5;
			}
			span {
				margin-top: 10px;
				font-size: 14px;
				line-height: 1.5;
			}
			small {
				margin-top: 6px;
				font-size: 12px;
			}
		}
		&[lang="en"] p {
			strong { text-indent: .125em; }
			em     { margin-right: -.125em; }
			span   { margin-right: -.125em; }
			small  {}
		}
		&[lang="ja"] p {
			strong { text-indent: .5em; }
			em     { margin-right: -.67em; text-indent: -.67em; }
			span   { margin-right: -.67em; text-indent: 0; }
			small  {}
		}
	}
	> .book-icon {
		@include book-icon($Catcher-Icon_Size, white, rgb(136,136,136));
		position: absolute;
		z-index: 10;
		@include trbl(auto, 0, $Catcher-CenterLine_Bottom);
		margin: 0 auto;
		opacity: .8;
		//transform-origin: 50% 100%;
		transition: $Catcher-Icon_Transition;
	}
	> input {
		visibility: hidden;
	}
	&:after {
		content: "";
		display: block;
		box-sizing: border-box;
		position: absolute;
		z-index: 1;
		@include trbl(0);
		margin: auto;
		border: dashed 4px rgba(white, 0.5);
		border-radius: 24px;
		@include size(
			calc(100% - #{$Catcher-Area_Margin * 2 }),
			calc(100% - #{$Catcher-Area_Margin * 2 + $GLOBAL__BottomBar_Height})
		);
		@include max(768px) {
			@include size(
				calc(100% - #{$Catcher-Area_Narrow_Margin * 2 }),
				calc(100% - #{$Catcher-Area_Narrow_Margin * 2 + $GLOBAL__BottomBar_Height})
			);
		}
		background: rgba(white, 0);
		transform: translateY(#{$GLOBAL__BottomBar_Height * -0.5});
		transition: $Catcher_Transition;
	}
	html.dragenter &,
	&:hover {
		> .pgroup {
			p {
				strong {
					color: rgb(128,128,128);
					background-color: rgba(white, 1);
				}
			}
		}
		> .book-icon {
			opacity: 1;
			transform: rotate(4deg) scale(1.04);
			//span, &:after { background-color: gold; }
			//span:before, span:after { background-color: rgb(160,160,160); }
		}
		&:after {
			border-style: solid;
			border-width: 8px;
			border-color: rgba(white, .88);
			//background: rgb(160,160,160);
		}
	}
	&:active {
		> .pgroup {
			p {
				strong {
					opacity: .8;
				}
			}
		}
		> .book-icon {
			//opacity: .5;
			transform: rotate(8deg) scale(1);
		}
		&:after {
			border-width: 16px;
			border-color: rgba(white, .44);
		}
	}
}




// ================================================================================
// + Panel
// --------------------------------------------------------------------------------


div#bibi-panel {
	box-sizing: border-box;
	overflow: hidden;
	z-index: $GLOBAL__Panel_ZIndex;
	position: absolute;
	left: 0;
	top: 0;
	@include size(100%);
	background: rgb(246,246,246);
	opacity: 0;
	transition: 0.15s ease-out;
	transform: translateY(-100%);
	html.panel-opened & {
		transform: none;
		opacity: 1;
		transition: 0.15s ease-in;
		user-select: auto;
	}
}


// - BottomBar
// --------------------------------------------------------------------------------

div#bibi-panel:after {
	content: "";
	box-sizing: border-box;
	display: block;
	position: absolute;
	z-index: $GLOBAL__Panel-BottomBar_ZIndex;
	left: 0; right: 0; bottom: 0;
	margin: 0 auto;
	padding: 4px;
	border-style: solid; border-width: 1px 0;
	@include size(100%, $GLOBAL__BottomBar_Height);
	border-color: rgb(232,232,232);
	background: rgba(240,240,240,0.9);
	html.view-horizontal &,
	html.page-rtl.panel-opened & {
		bottom: $GLOBAL__Scrollbar-Track_Size; // to be overwritten by JavaScript ... O.ScrollBars.Height + "px"
	}
	html.veil-opened &,
	html.panel-opened &,
	html.subpanel-opened & {
		bottom: 0 !important;
	}
}


// - BookInfo
// --------------------------------------------------------------------------------

div#bibi-panel-bookinfo {
	box-sizing: border-box;
	position: relative;
	z-index: $GLOBAL__Panel-BookInfo_ZIndex;
	@include size(100%);
}
	div#bibi-panel-bookinfo-box {
		box-sizing: border-box;
		margin-top: $GLOBAL__TopBar_Height;
		padding: 20px 30px;
		@include size(100%, calc(100% - #{$GLOBAL__BottomBar_Height}));
		-webkit-overflow-scrolling: touch;
		html.page-ltr &, html.Android.page-rtl & { overflow-x: hidden; overflow-y: scroll; @include writing-mode(horizontal-tb); }
		html.page-rtl & { overflow-x: scroll; overflow-y: hidden; @include writing-mode(vertical-rl); }
	}


// . Navigation
// --------------------------------------------------------------------------------

div#bibi-panel-bookinfo-navigation {
	box-sizing: border-box;
	html.page-rtl & {
		>*:first-child,
		>*:first-child >*:first-child,
		>*:first-child >*:first-child >*:first-child {
			margin-right: 0 !important;
		}
		span.tcy {
			@include text-combine-upright_all();
		}
	}
	html.page-ltr &, html.Android.page-rtl & {
		>*:first-child,
		>*:first-child >*:first-child,
		>*:first-child >*:first-child >*:first-child {
			margin-top: 0 !important;
		}
	}
	nav {
		$margin-before: 2em;
		$margin-after: 1em;
		line-height: 1.2;
		font-size: 20px;
		html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
		html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
		h1, h2, h3, h4, h5, h6 {
			$margin-before: 0;
			$margin-after: 1em;
			font-weight: bold;
			html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
			html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
		}
		small {
			font-size: .8em;
		}
		br +small {
			$margin-start: 2em;
			html.page-ltr &, html.Android.page-rtl & { margin: 0 0 0 $margin-start; }
			html.page-rtl & { margin: $margin-start 0 0 0; }
		}
		ul, ol {
			$margin-before: 0;
			$margin-after: 1em;
			font-size: .9em;
			html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
			html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
			li {
				$margin-before: 1em;
				$margin-after: 0;
				html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
				html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
				ul, ol {
					position: relative;
					$margin-before: 0;
					$margin-after: 0;
					html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
					html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
					&:before {
						content: "";
						display: block;
						position: absolute;
						$start: .175em;
						$before: 0;
						$breadth: 4px;
						$length: 100%;
						background: white;
						html.page-ltr &, html.Android.page-rtl & { left: $start; top: $before; @include size($breadth, $length); }
						html.page-rtl & { top: $start; right: $before; @include size($length, $breadth); }
					}
					li {
						$margin-before: .5em;
						$margin-after: 0;
						$margin-start: 1em;
						html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after $margin-start; }
						html.page-rtl & { margin: $margin-start $margin-before 0 $margin-after; }
					}
				}
			}
		}
		a {
			border: solid rgb(216,216,216);
			html.page-rtl & { border-width: 0 1px 0 0; padding-right: .1em; }
			html.page-ltr & { border-width: 0 0 1px 0; padding-bottom: .1em; }
			color: rgb(64,64,64);
			text-decoration: none;
			transition: linear .15s;
			&:hover {
				border-color: steelblue;
				color: steelblue;
				transition: none;
			}
			&.bibi-bookinfo-inactive-link {
				color: inherit !important;
				border: none 0 !important;
				cursor: default !important;
				&:hover {
					color: inherit !important;
				}
			}
		}
	}
	nav.bibi-nav-landmarks,
	nav.bibi-nav-page-list {
		font-size: 16px;
		h1, h2, h3, h4, h5, h6 {
			$margin-before: 0;
			$margin-after: .25em;
			html.page-ltr &, html.Android.page-rtl & { margin: $margin-before 0 $margin-after 0; }
			html.page-rtl & { margin: 0 $margin-before 0 $margin-after; }
		}
		ul, ol {
			overflow: hidden;
			$padding-after: .25em;
			html.page-ltr &, html.Android.page-rtl & { padding: 0 0 $padding-after 0; }
			html.page-rtl & { padding: 0 0 0 $padding-after; }
			li {
				float: left;
				$padding-end: 1em;
				html.page-ltr &, html.Android.page-rtl & { padding: 0 $padding-end 0 0; &:last-child { padding: 0; } }
				html.page-rtl & { padding: 0 0 $padding-end 0; &:last-child { padding: 0; } }
			}
		}
	}
}


// . Cover
// --------------------------------------------------------------------------------

div#bibi-panel-bookinfo-cover {
	border: solid 0 rgb(232,232,232);
	html.page-ltr &, html.Android.page-rtl & { margin: 2em 30px 0 0; padding: 2em 0; border-width: 1px 0 0 0; }
	html.page-rtl & { margin: 0 2em 30px 0; padding: 0 2em; border-width: 0 1px 0 0; }
	img {
		@include max-size(40%); @include max-size(40vw, 40vh);
		html.page-ltr &, html.Android.page-rtl & { margin: 0 0 .75em 0; }
		html.page-rtl & { margin: 0 0 0 .75em; }
	}
	p#bibi-panel-bookinfo-cover-info {
		color: rgb(160,160,160);
		strong, em, span {
			display: block;
			line-height: 1.2;
			html.page-ltr &, html.Android.page-rtl & { margin: 0 0 .5rem 0; }
			html.page-rtl & { margin: 0 0 0 .5rem; }
		}
		strong {
			font-size: 16px;
			font-weight: bold;
		}
		em {
			font-size: 14px;
		}
		span {
			font-size: 12px;
		}
	}
}




// ================================================================================
// + Shade
// --------------------------------------------------------------------------------


/*
div#bibi-shade {
	display: none;
	position: absolute;
	z-index: $GLOBAL__Shade_ZIndex;
	@include trbl(0);
	margin: 0;
	@include size(100%);
	background: black;//$bibi-Background;
	opacity: 0;
	transition: .15s ease;
	html.shade-opened & {
		display: block;
	}
	html.shade-opened.shade-visible & {
		opacity: 0.33;
	}
	html.shade-opened.shade-visible.panel-opened & {
	}
}
*/




// ================================================================================
// + Subpanel
// --------------------------------------------------------------------------------

$Subpanel_BackgroundColor: rgba(252,252,252, 0.96);
$Subpanel_Margin: $GLOBAL__ButtonGroup_Margin;

$Subpanel-Scrollbar-Track_Size: 6px;
$Subpanel-Scrollbar-Thumb_Size: 2px;
$Subpanel-Scrollbar-Thumb_BackgroundColor: rgb(128,128,128);
$Subpanel-Scrollbar-Track_BackgroundColor: rgb(248,248,248);

div.bibi-subpanel {
	& {
		box-sizing: border-box;
		position: absolute;
		z-index: $GLOBAL__Subpanel_ZIndex;
		right: $Subpanel_Margin;
		top: $GLOBAL__TopBar_Height + $Subpanel_Margin;
		margin: auto;
		width: calc(100% - #{$Subpanel_Margin * 2});
		max-width: 320px - $Subpanel_Margin * 2;
		border-radius: 4px;
		background: $Subpanel_BackgroundColor;
		transform: translateY($Subpanel_Margin * -2) scale(0);
		opacity: 0.25;
		transition: transform 0.15s ease-out;
		overflow: auto; -webkit-overflow-scrolling: touch;
		&::-webkit-scrollbar {
			@include size($Subpanel-Scrollbar-Track_Size);
		}
		&::-webkit-scrollbar-track {
			background: $Subpanel-Scrollbar-Track_BackgroundColor;
		}
		&::-webkit-scrollbar-thumb {
			border-radius: $Subpanel-Scrollbar-Track_Size * 0.5;
			border: solid (($Subpanel-Scrollbar-Track_Size - $Subpanel-Scrollbar-Thumb_Size) * 0.5) $Subpanel-Scrollbar-Track_BackgroundColor;
			background: $Subpanel-Scrollbar-Thumb_BackgroundColor;
			&:hover  { background: $GLOBAL__Scrollbar-Thumb_BackgroundColor__Hover; }
			&:active { background: $GLOBAL__Scrollbar-Thumb_BackgroundColor__Active; }
		}
	}
	html.appearance-horizontal & { max-height: calc(100% - #{$GLOBAL__TopBar_Height + $GLOBAL__Scrollbar-Track_Size + $Subpanel_Margin * 2}); }
	html.appearance-vertical   & { max-height: calc(100% - #{$GLOBAL__TopBar_Height + $Subpanel_Margin * 2}); }
	&.opened {
		opacity: 1;
		transform: none;
		transition: transform 0.2s cubic-bezier(.2,.8,.8,1.1);
		box-shadow: rgba(black, 0.1) 0 2px 2px;
	}
}


// - Sub Panel > Section
// --------------------------------------------------------------------------------

.bibi-subpanel-section {
	margin: ($GLOBAL__ButtonGroup_Margin * 4) 0;
	strong {
		font-weight: bold;
	}
	.bibi-hgroup, .bibi-pgroup, .bibi-buttongroup {
	}
		.bibi-h, .bibi-p, .bibi-buttonbox,
		.bibi-h-label, .bibi-button {
			display: block;
			box-sizing: border-box;
		}
		.bibi-h,
		.bibi-button {
			padding-left: ($GLOBAL__ButtonGroup_Margin * 2);
			padding-right: ($GLOBAL__ButtonGroup_Margin * 2);
		}
		.bibi-p {
			padding-left: ($GLOBAL__ButtonGroup_Margin * 2.5);
			padding-right: ($GLOBAL__ButtonGroup_Margin * 2);
		}
			a.bibi-button {
				text-decoration: none;
			}
	.bibi-hgroup {
	}
		.bibi-h {
		}
			.bibi-h-label {
				padding-bottom: ($GLOBAL__ButtonGroup_Margin * 1.5);
				line-height: 1.2;
				font-size: 12px;
				font-weight: bold;
				color: rgb(64,64,64);
				>small {
					display: block;
					position: relative;
					overflow: hidden;
					padding: .2em 0 0 .9em;
					text-overflow: ellipsis;
					word-break: keep-all;
					white-space: nowrap;
					font-size: 10px;
					color: rgb(128,128,128);
					&:before {
						@include font-icon("Material Icons");
						position: absolute;
						left: -.1em;
						top: .225em;
						font-size: 1.1em;
						content: "\e5cc"; // chevron_right
						color: rgb(160,160,160);
					}
				}
			}
	.bibi-pgroup {
		border: solid 0 rgba(black, 0.1);
		overflow: hidden;
		color: rgb(64,64,64);
		background: white;//rgba(white, 0.9);
	}
	.bibi-hgroup + .bibi-pgroup,
	.bibi-pgroup + .bibi-pgroup,
	.bibi-pgroup:first-child {
		border-top-width:    1px;
	}
	.bibi-pgroup:last-child  {
		border-bottom-width: 1px;
	}
		.bibi-p {
			margin: 4px 0 0;
			&:first-child { margin-top: 8px; }
			&:last-child  { margin-bottom: 6px; }
			line-height: 1.4;
			font-size: 12px;
			text-align: justify;
			small {
				font-size: 10px;
			}
			.code {
				font-size: 12px;
				font-family: monospace;
				word-break: break-all;
				color: rgb(96,96,96);
			}
			.block {
				box-sizing: border-box;
				display: block;
				width: 100%;
			}
			input.block {
				border: solid 1px rgb(234,234,234);
				padding: .5em;
			}
			strong {
				font-weight: bold;
			}
			em {
				background: rgba(black, 0.075);
			}
		}
	.bibi-buttongroup { // ul
		border: solid rgba(black, 0.1); border-width: 1px 0;
		overflow: hidden;
	}
	.bibi-buttongroup + .bibi-buttongroup { // ul
		margin-top: $GLOBAL__TopBar_Height / 6;
	}
		.bibi-buttonbox { // li
			line-height: 1.2;
			font-size: 14px;
		}
			.bibi-button { // a, span
				position: relative;
				z-index: 1;
				margin: -1px 0;
				border: solid rgba(black, 0.1); border-width: 1px 0; &.bibi-button-radio { border-style: dashed; }// &:first-child { border-top-width: 0; }
				min-height: $GLOBAL__TopBar_Height;
				color: rgb(64,64,64);
				background: white;//rgba(white, 0.9);
				.bibi-button-iconbox,
				.bibi-button-label {
					display: inline-block;
					vertical-align: top;
				}
				.bibi-button-iconbox {
					margin-top: ($GLOBAL__TopBar_Height - $GLOBAL__Subpanel-Icon_Size) / 2;
					margin-right: 6px;
				}
				.bibi-button-label {
					margin-top: 12px;
					font-size: 13px;
					line-height: 1.2;
					small {
						font-size: .875em;
					}
					span.non-visual-in-label {
						@extend .non-visual;
					}
				}
				&:before, &:after {
					display: block;
					position: absolute;
				}
				&:before {
					content: "";
					z-index: 10;
					@include trbl(0);
					@include size(100%);
				}
				&:after {
					z-index: 1;
					@include font-icon("Material Icons");
					@include trbl(0, $GLOBAL__ButtonGroup_Margin * 2, 0, auto);
					margin: auto;
					@include size(/*20px*/auto, .9em);
					line-height: 1;
					font-size: 16px;
					text-align: right;
					color: rgb(160,160,160);
					transition: .2s ease-in-out;
				}
				&.default.hover,
				&.default:hover,
				&.bibi-button-toggle.active.hover,
				&.bibi-button-toggle.active:hover {
					border-style: solid;
					border-color: rgba($GLOBAL__Subpanel_KeyColor, 0.1);
					background: rgba(244,248,252, 0.8);
					cursor: pointer;
					color: $GLOBAL__Subpanel_KeyColor;
					z-index: 2;
					&:after {
						color: $GLOBAL__Subpanel_KeyColor;
					}
				}
				&.disabled,
				&.disabled.hover,
				&.disabled:hover {
					.bibi-button-iconbox,
					.bibi-button-label {
						opacity: 0.5 !important;
					}
				}
			}
			.bibi-button-link {
				&:after {
					content: "\e5cc"; // chevron_right
				}
			}
			.bibi-button-toggle,
			.bibi-button-radio {
				&:after {
					color: rgb(160,160,160);
				}
				&.active {
					.bibi-button-label {
						font-weight: bold;
					}
					&:after {
						//margin-right: -1px;
						//font-size: 18px;
						color: $GLOBAL__Subpanel_KeyColor;
					}
				}
			}
			.bibi-button-toggle {
				&:after {
					content: "\e835"; // check_box_outline_blank
				}
				&.active {
					&:after {
						content: "\e834"; // check_box
					}
				}
			}
			.bibi-button-radio {
				&:after {
					content: "\e836"; // radio_button_unchecked
				}
				&.active {
					&:after {
						content: "\e837"; // radio_button_checked
						content: "\e86c"; // check_circle
					}
				}
			}
	.bibi-buttongroup-tiled {
		display: flex;
		align-items: stretch;
		align-content: center;
		flex: auto;
		width: 100%;
		.bibi-buttonbox {
			width: 100%;
			margin: 0;
			.bibi-button {
				margin: 0 -1px;
				border-width: 0 1px;
				padding-right: $GLOBAL__ButtonGroup_Margin;
				.bibi-button-iconbox {
					
				}
				.bibi-button-label {
					margin-top: 12.5px;
					font-size: 12px;
				}
			}
			.bibi-button-link {
				&:after {
					margin-right: -5px;
				}
			}
		}
	}
}





// ================================================================================
// + Menu
// --------------------------------------------------------------------------------

$Menu_BackgroundColor:         rgba(white, 0  );
$Menu_BackgroundColor__Hover:  rgba(white,  .9);
$Menu_BackgroundColor__Active: rgba(white, 1  );
$Menu_BorderBottomColor:         rgba(black, 0);
$Menu_BorderBottomColor__Hover:  $Menu_BorderBottomColor;
$Menu_BorderBottomColor__Active: $Menu_BorderBottomColor__Hover;
$Menu_BoxShadow__Active: 0 0 16px rgba(black, 0.125);

// Not-BookFullHeight (NotBFH) ... html:not(.book-full-height)
$NotBFH-Menu_BackgroundColor:         rgba(white, 1  );
$NotBFH-Menu_BackgroundColor__Hover:  $NotBFH-Menu_BackgroundColor;
$NotBFH-Menu_BackgroundColor__Active: $NotBFH-Menu_BackgroundColor__Hover;
$NotBFH-Menu_BorderBottomColor:         rgba(black, .05);
$NotBFH-Menu_BorderBottomColor__Hover:  $NotBFH-Menu_BorderBottomColor;
$NotBFH-Menu_BorderBottomColor__Active: $NotBFH-Menu_BorderBottomColor__Hover;
$NotBFH-Menu_BoxShadow__Active: $Menu_BoxShadow__Active;

div#bibi-menu {
	& {
		box-sizing: border-box;
		position: absolute;
		z-index: $GLOBAL__Menu_ZIndex;
		@include trbl(0, 0, auto);
		left: 0;
		right: 0;
		margin: 0;
		border-bottom: solid 1px transparent;
		height: $GLOBAL__TopBar_Height;
		width: 100%;
		background: transparent;
	}
	&, & ul {
		transition: .125s linear;
	}
}

html.book-full-height {
	&                 div#bibi-menu { background-color: $Menu_BackgroundColor;         border-bottom-color: $Menu_BorderBottomColor; }
	&                 div#bibi-menu.hover,
	&.subpanel-opened div#bibi-menu { background-color: $Menu_BackgroundColor__Hover;  border-bottom-color: $Menu_BorderBottomColor__Hover; }
	&.menu-opened     div#bibi-menu { background-color: $Menu_BackgroundColor__Active; border-bottom-color: $Menu_BorderBottomColor__Active; box-shadow: $Menu_BoxShadow__Active; }
}

html:not(.book-full-height) {
	&                 div#bibi-menu { background-color: $NotBFH-Menu_BackgroundColor;         border-bottom-color: $NotBFH-Menu_BorderBottomColor; }
	&                 div#bibi-menu.hover,
	&.subpanel-opened div#bibi-menu { background-color: $NotBFH-Menu_BackgroundColor__Hover;  border-bottom-color: $NotBFH-Menu_BorderBottomColor__Hover; }
	&.menu-opened     div#bibi-menu { background-color: $NotBFH-Menu_BackgroundColor__Active; border-bottom-color: $NotBFH-Menu_BorderBottomColor__Active; box-shadow: $NotBFH-Menu_BoxShadow__Active; }
}

/*html.appearance-vertical:not(.veil-opened):not(.slider-opened) {
	&                 div#bibi-menu,
	&.panel-opened    div#bibi-menu,
	&.subpanel-opened div#bibi-menu { width: 100%; } // override by script
}*/

html.appearance-vertical:not(.veil-opened).slider-opened {
	&                 div#bibi-menu { width: calc(100% - #{$GLOBAL__Slider_Size}); }
	&.panel-opened    div#bibi-menu,
	&.subpanel-opened div#bibi-menu { width: 100%; padding-right: $GLOBAL__Slider_Size; }
}

html.without-menubar,
html.waiting-file {
	&                 div#bibi-menu { display: none !important; }
}


// - Menu-L & Menu-R
// --------------------------------------------------------------------------------

div#bibi-menu-l,
div#bibi-menu-r {
	position: relative;
	z-index: 1;
	box-sizing: border-box;
	height: 100%;
	color: white;
	transition: opacity 0.75s linear;
	ul {
		& {
			position: relative;
			padding: $GLOBAL__ButtonGroup_Margin;
			height: $GLOBAL__Icon_Size;
			opacity: 0;
			&.sticky {
				opacity: 0;
			}
			&:before {
				content: "";
				display: block;
				position: absolute;
				top: $GLOBAL__ButtonGroup_Margin;
				@include size(1px, $GLOBAL__Icon_Size);
				background: rgba(216,216,216, 0.5);
			}
			li {
				@include size($GLOBAL__Icon_Size);
				.bibi-button {
					position: relative;
					z-index: 1;
					&.hover, &.active {
						z-index: 10;
					}
					span.bibi-button-label {
						font-size: 0;
						color: transparent;
					}
				}
			}
		}
		html.waiting & {
			opacity: 0.5;
			&.sticky {
				opacity: 0.5;
			}
		}
		div#bibi-menu.hover &,
		div#bibi-menu.hot &,
		html.menu-opened &,
		html.panel-opened &,
		html.subpanel-opened &,
		html:not(.book-full-height) & {
			opacity: 1;
			&.sticky {
				opacity: 1;
			}
		}
	}
	ul.bibi-buttongroup-tiled {
		li:not(:first-child):not(:last-child) {
			.bibi-button {
				.bibi-button-iconbox {
					.bibi-icon {
						border-radius: 0;
					}
				}
			}
		}
	}
}

div#bibi-menu-l {
	float: left;
	ul {
		float: left;
		padding-left: $GLOBAL__ButtonGroup_Margin + 1px;
		&:before {
			left: 0;
		}
		&:first-child {
			padding-left: $GLOBAL__ButtonGroup_Margin;
			&:before {
				display: none;
			}
		}
		li {
			float: left;
			margin-left: $GLOBAL__ButtonGroup_Margin / 2; &:first-child { margin-left: 0; }
		}
	}
	ul.bibi-buttongroup-tiled {
		li {
			margin-left: -1px;
		}
		li:first-child:not(:last-child) {
			.bibi-button {
				.bibi-button-iconbox {
					.bibi-icon {
						border-top-right-radius: 0;
						border-bottom-right-radius: 0;
					}
				}
			}
		}
		li:last-child:not(:first-child) {
			.bibi-button {
				.bibi-button-iconbox {
					.bibi-icon {
						border-top-left-radius: 0;
						border-bottom-left-radius: 0;
					}
				}
			}
		}
	}
}

div#bibi-menu-r {
	float: right;
	ul {
		float: right;
		padding-right: $GLOBAL__ButtonGroup_Margin + 1px;
		&:before {
			right: 0;
		}
		&:first-child {
			padding-right: $GLOBAL__ButtonGroup_Margin;
			&:before {
				display: none;
			}
		}
		li {
			float: right;
			margin-right: $GLOBAL__ButtonGroup_Margin / 2; &:first-child { margin-right: 0; }
		}
	}
	ul.bibi-buttongroup-tiled {
		li {
			margin-right: -1px;
		}
		li:first-child:not(:last-child) {
			.bibi-button {
				.bibi-button-iconbox {
					.bibi-icon {
						border-top-left-radius: 0;
						border-bottom-left-radius: 0;
					}
				}
			}
		}
		li:last-child:not(:first-child) {
			.bibi-button {
				.bibi-button-iconbox {
					.bibi-icon {
						border-top-right-radius: 0;
						border-bottom-right-radius: 0;
					}
				}
			}
		}
	}
}


// - Button Behaviors
// --------------------------------------------------------------------------------

ul#bibi-buttongroup_font-size {
	html.book-pre-paginated & {
		display: none;
	}
}

ul#bibi-buttongroup_loupe {
	html.waiting &,
	html.book-reflowable & {
		display: none;
	}
}



// ================================================================================
// + Help
// --------------------------------------------------------------------------------


div#bibi-help {
	box-sizing: border-box;
	display: none;
	position: absolute;
	z-index: $GLOBAL__Help_ZIndex;
	margin: 0;
	border-top: solid 1px rgb(240,240,240);
	padding: 0 8px 0 56px;
	@include size(100%, $GLOBAL__BottomBar_Height);
	left: 0;
	bottom: 0;
	opacity: 0;
	transition: .2s linear;
	background: rgba(240,240,240,0.96);
	html.view-horizontal &,
	html.page-rtl.panel-opened & {
		bottom: $GLOBAL__Scrollbar-Track_Size; // to be overwritten by JavaScript ... O.ScrollBars.Height + "px"
	}
	html.veil-opened &,
	html.panel-opened &,
	html.subpanel-opened & {
		bottom: 0 !important;
	}
	html.slider-opened.view-paged &,
	html.slider-opened.view-horizontal & {
		bottom: $GLOBAL__Slider_Size !important;
	}
	p {
		line-height: $GLOBAL__BottomBar_Height * 1.1;
		text-align: center;
		font-size: 12px;
		font-weight: bold;
		color: rgb(96,96,96);
		small {
			font-size: .875em;
		}
	}
	&.active {
		display: block;
		&.shown {
			opacity: 1;
		}
	}
}

html.slider-opened:not(.panel-opened).view-vertical div#bibi-help {
	width: calc(100% - #{$GLOBAL__Slider_Size});
}




// ================================================================================
// + PoweredBy
// --------------------------------------------------------------------------------


div#bibi-poweredby {
	box-sizing: border-box;
	display: block;
	position: absolute;
	z-index: $GLOBAL__PoweredBy_ZIndex;
	@include trbl(auto, 0, 0);
	margin: 0 auto;
	//padding: 4px;
	height: $GLOBAL__BottomBar_Height;
	text-align: right;
	font-size: 14px;
	transition: .1s linear;
	transform: scale(0);
	html.waiting-file &,
	html.waiting &,
	html.panel-opened & {
		transform: none;
	}
	html.view-horizontal &,
    html.page-rtl.panel-opened & {
		bottom: $GLOBAL__Scrollbar-Track_Size; // to be overwritten by JavaScript ... O.ScrollBars.Height + "px"
	}
	html.veil-opened &,
	html.panel-opened &,
	html.subpanel-opened & {
		bottom: 0 !important;
	}
	p {
		a {
			$PowerdBy-Logo-Image_OriginalWidth: 144px;
			$PowerdBy-Logo-Image_OriginalHeight: 72px;
			$PowerdBy-Logo-Image_Height: 16px;
			$PowerdBy-Logo-Image_Width: $PowerdBy-Logo-Image_Height * ($PowerdBy-Logo-Image_OriginalWidth / $PowerdBy-Logo-Image_OriginalHeight);
			$PowerdBy-Logo-Box_PaddingVertical: 4px;
			$PowerdBy-Logo-Box_PaddingHorizontal: 8px;
			$PowerdBy-Logo-Box_Height: $PowerdBy-Logo-Image_Height + $PowerdBy-Logo-Box_PaddingVertical * 2;
			$PowerdBy-Logo-Box_Width: $PowerdBy-Logo-Image_Width + $PowerdBy-Logo-Box_PaddingHorizontal * 2;
			$PowerdBy-Logo-Box_Margin: ($GLOBAL__BottomBar_Height - $PowerdBy-Logo-Box_Height) / 2;
			display: block;
			box-sizing: border-box;
			position: absolute;
			@include trbl(0, auto, 0, $PowerdBy-Logo-Box_Margin);
			text-decoration: none;
			color: black;
			margin: auto 0;
			@include size($PowerdBy-Logo-Box_Width, $PowerdBy-Logo-Box_Height);
			border-radius: 2px;
			transition: .2s linear;
			background: transparent none no-repeat center (($PowerdBy-Logo-Box_Height - $PowerdBy-Logo-Image_Height) / 2 + 2px);
			background-size: $PowerdBy-Logo-Image_Width $PowerdBy-Logo-Image_Height;
			text-align: center;
			font-size: $PowerdBy-Logo-Image_Height;
			line-height: $PowerdBy-Logo-Box_Height + 2px;
			color: transparent;
		}
		a:hover {
			transition: .075s linear;
		}
	}
}

html.waiting-file div#bibi-poweredby,
html.waiting div#bibi-poweredby {
	p {
		a {
			background-color: rgba(128,128,128, 0.5);
			background-image: url(../images/bibi-logo_white.png);
		}
		a:hover {
			background-color: rgba(160,160,160, 0.9);
		}
	}
}

html.panel-opened div#bibi-poweredby {
	p {
		a {
			opacity: 0.5;
			background-color: transparent;
			background-image: url(../images/bibi-logo_black.png);
		}
		a:hover {
			opacity: 1;
		}
	}
}



// ================================================================================
// + Nombre
// --------------------------------------------------------------------------------

$Nombre_Width: 120px;
$Nombre_Height: 20px;

$Nombre_Color: rgb(64,64,64);
$Nombre-Current_Color: darken($Nombre_Color, 25%);
$Nombre-Percent_Color: lighten($Nombre_Color, 25%);

$Nombre_BackgroundColor: rgba(240,240,240,0.9);
$Nombre_BackgroundColor: rgb(240,240,240);

div#bibi-nombre {
	box-sizing: border-box;
	overflow: hidden;
	position: absolute;
	z-index: $GLOBAL__Nombre_ZIndex;
	margin: auto;
	border-radius: $Nombre_Height * 0.5;
	@include size($Nombre_Width, $Nombre_Height);
	line-height: $Nombre_Height;
	font-size: 12px;
	text-align: center;
	color: $Nombre_Color;
	background: $Nombre_BackgroundColor;
	opacity: 0;
	transition: 0.125s ease-out;
	html.view-paged &,
	html.view-horizontal & {
		@include trbl(auto, -100%);
	}
	html.view-paged & {
		bottom: 2px;
	}
	html.view-horizontal & {
		bottom: $GLOBAL__Scrollbar-Track_Size + 2px; // `bottom` is to be overwritten by JavaScript ... (O.ScrollBars.Height + 2) + "px"
	}
	html.view-vertical & {
		@include trbl(
			-100%,
			$GLOBAL__Scrollbar-Track_Size + 2px, // `right` is to be overwritten by JavaScript ... (O.ScrollBars.Width  + 2) + "px"
			-100%,
			auto
		);
		transform: rotate(90deg) translateY(($Nombre_Width - $Nombre_Height) * -0.5);
	}
	html.slider-opened.appearance-horizontal & {
		bottom: $GLOBAL__Slider_Size + 2px !important;
	}
	html.slider-opened.appearance-vertical & {
		right: $GLOBAL__Slider_Size + 2px !important;
	}
	& {
		display: none;
	}
	&.active {
		display: block;
	}
	&.hot {
		opacity: 1;
		transition: 0.125s ease-out;
	}
	span {
		display: inline-block;
	}
}
	span#bibi-nombre-current {
		font-size: 1.2em;
		font-weight: bold;
		color: $Nombre-Current_Color;
	}
	span#bibi-nombre-delimiter {
		margin: 0 0.1em 0 0.2em;
	}
	span#bibi-nombre-total {
	}
	span#bibi-nombre-percent {
		margin-left: .25em;
		color: $Nombre-Percent_Color;
		span.unit {
			margin-left: .125em;
			font-size: .75em;
		}
	}



// ================================================================================
// + Slider
// --------------------------------------------------------------------------------


$Slider_Transition: .15s ease;

div#bibi-slider {
	& {
		overflow: hidden;
		position: relative;
		box-sizing: border-box;
		display: block;
		position: absolute;
		z-index: $GLOBAL__Slider_ZIndex;
		cursor: pointer;
		transition: $Slider_Transition;
		will-change: height;
		&:after {
			content: "";
			display: block;
			box-sizing: border-box;
			position: absolute;
			z-index: 1;
			border: solid 0 $GLOBAL__Scrollbar-Track_BorderColor;
			@include size(100%);
			background: $GLOBAL__Scrollbar-Track_BackgroundColor;
		}
	}
	html.appearance-horizontal & {
		@include trbl(auto, 0, 0, 0);
		@include size(100%, $GLOBAL__Scrollbar-Track_Size);
		&:after {
			border-top-width: 1px;
		}
	}
	html.appearance-vertical & {
		@include trbl(0, 0, 0, auto);
		@include size($GLOBAL__Scrollbar-Track_Size, 100%);
		&:after {
			border-left-width: 1px;
		}
	}
	html.slider-opened & {
		overflow: visible;
		box-shadow: 0 0 16px rgba(black, 0.125);
		&:after {
			background: rgb(222,222,222);
		}
	}
	html.slider-opened.appearance-horizontal & {
		height: $GLOBAL__Slider_Size !important;
		&:after {
			border-top-color: darken($GLOBAL__Scrollbar-Track_BackgroundColor, 20%);
			//background: linear-gradient(to top, $GLOBAL__Scrollbar-Track_BackgroundColor 0, $GLOBAL__Scrollbar-Track_BackgroundColor 16px, rgba($GLOBAL__Scrollbar-Track_BackgroundColor, .75) 100%);
			//background: linear-gradient(to top, $GLOBAL__Scrollbar-Track_BackgroundColor 0, $GLOBAL__Scrollbar-Track_BackgroundColor 16px, darken($GLOBAL__Scrollbar-Track_BackgroundColor, 10%) 100%);
		}
	}
	html.slider-opened.appearance-vertical & {
		width: $GLOBAL__Slider_Size !important;
		&:after {
			border-left-color: darken($GLOBAL__Scrollbar-Track_BackgroundColor, 20%);
			//background: linear-gradient(to left, $GLOBAL__Scrollbar-Track_BackgroundColor 0, $GLOBAL__Scrollbar-Track_BackgroundColor 16px, rgba($GLOBAL__Scrollbar-Track_BackgroundColor, .75) 100%);
			//background: linear-gradient(to left, $GLOBAL__Scrollbar-Track_BackgroundColor 0, $GLOBAL__Scrollbar-Track_BackgroundColor 16px, darken($GLOBAL__Scrollbar-Track_BackgroundColor, 10%) 100%);
		}
	}
	html.slider-sliding & {
		transition: none;
	}
	html.busy & {
		opacity: 0;
		transition: none;
	}
}


// - UI Box (Edgebar Box, Bookmap Box)
// --------------------------------------------------------------------------------

$Slider_Padding: $GLOBAL__Scrollbar-Thumb_Size;

div#bibi-slider-edgebar-box,
div#bibi-slider-bookmap-box {
	box-sizing: border-box;
	position: absolute;
	//@include trbl(-100vw, -100vh);
	@include trbl(0);
	z-index: 10;
	margin: auto;
	background: transparent;
	html.appearance-horizontal & {
		@include trbl(1px, 0, auto, 0);
		@include size(
			calc(100% - #{$GLOBAL__Scrollbar-Thumb_Size * 2}), // 100%,
			calc(100% - 1px)
		);
		will-change: height;
	}
	html.appearance-horizontal.slider-opened & {
		top: 1px + $Slider_Padding;
		height: calc(100% - #{1px + $Slider_Padding * 2});
	}
	html.appearance-vertical & {
		@include trbl(0, auto, 0, 1px);
		@include size(
			calc(100% - 1px),
			calc(100% - #{$GLOBAL__Scrollbar-Thumb_Size * 2}) // 100%
		);
		will-change: width;
	}
	html.appearance-vertical.slider-opened & {
		left: 1px + $Slider_Padding;
		width: calc(100% - #{1px + $Slider_Padding * 2});
	}
}


// - Edgebar, Bookmap
// --------------------------------------------------------------------------------

div#bibi-slider-edgebar,
div#bibi-slider-bookmap {
	box-sizing: border-box;
	position: absolute;
	z-index: 10;
	@include trbl(0);
	@include size(100%);
	margin: auto;
}


// - Edgebar
// --------------------------------------------------------------------------------

div#bibi-slider-edgebar {
	background: white;
}


// - Bookmap
// --------------------------------------------------------------------------------

div#bibi-slider-bookmap {
	display: flex;
	flex-wrap: nowrap;
	justify-content: space-between;
	html.appearance-ltr & { flex-direction: row; }
	html.appearance-rtl & { flex-direction: row-reverse; }
	html.appearance-ttb & { flex-direction: column; }
	box-sizing: border-box;
	position: absolute;
	z-index: 10;
	@include trbl(0);
	@include size(100%);
	margin: auto;
}

	div.bookmap-spread-box,
	div.bookmap-spread,
	div.bookmap-item-box,
	span.bookmap-item,
	span.bookmap-page {
		html.appearance-horizontal & { height: 100%; }
		html.appearance-vertical   & { width: 100%; }
	}


// - . Bookmap > Spread Box
// --------------------------------------------------------------------------------

$Slider-Bookmap-SpreadBox_Color: transparent;
$Slider-Bookmap-SpreadBox_Color__Hover: rgba(steelblue, .33);

div.bookmap-spread-box {
	box-sizing: border-box;
	flex-shrink: 0;
	position: relative;
	background: $Slider-Bookmap-SpreadBox_Color;
	&.hover {
		//background: $Slider-Bookmap-SpreadBox_Color__Hover;
	}
}


// - . Bookmap > Spread Box > Spread
// --------------------------------------------------------------------------------

$Slider-Bookmap-Spread_Background: rgba(white, .5);

div.bookmap-spread {
	box-sizing: border-box;
	position: absolute;
	z-index: 1;
	@include trbl(0);
	margin: auto;
	display: flex;
	flex-wrap: nowrap;
	justify-content: center;
	html.page-ltr &                                            { flex-direction: row; }
	html.page-rtl &                                            { flex-direction: row-reverse; }
	html.view-vertical div.bookmap-spread-box:not(.spreaded) & { flex-direction: column; }
	div.bookmap-spread-box.single-item-spread-before & { justify-content: flex-start; }
	div.bookmap-spread-box.single-item-spread-after &  { justify-content: flex-end; }
	align-items: center;
	//border: solid 1px white;
	//html.appearance-rtl & { transform: translateX(1px); }
	//html.appearance-ltr & { transform: translateX(-1px); }
	//html.appearance-ttb &   { transform: translateY(-1px); }
	//html.appearance-horizontal & { border-width: 0 .5px; }
	//html.appearance-vertical &   { border-width: .5px 0; }
	background: $Slider-Bookmap-Spread_Background;
}


// - . Bookmap > Spread Box > Spread > Item Box
// --------------------------------------------------------------------------------

$Slider-Bookmap-ItemBox_BorderColor__ForReflowable: rgb(216,216,216);

div.bookmap-item-box {
	box-sizing: border-box;
	flex-shrink: 0;
	position: relative;
	&.reflowable {
		display: flex;
		html.appearance-ltr & { flex-direction: row; }
		html.appearance-rtl & { flex-direction: row-reverse; }
		html.appearance-ttb & { flex-direction: column; }
		flex-wrap: nowrap;
		justify-content: flex-start;
		align-items: center;
		&:before {
			content: "";
			display: block;
			position: absolute;
			background: $Slider-Bookmap-ItemBox_BorderColor__ForReflowable;
			html.book-reflowable.appearance-horizontal & { @include size(1px, calc(100% + 2px)); top: -1px; bottom: -1px; margin: auto 0; }
			html.book-reflowable.appearance-vertical & { @include size(calc(100% + 2px), 1px); left: -1px; right: -1px; margin: 0 auto; }
			html.book-reflowable.appearance-rtl & { right: -1px; left: auto; }
			html.book-reflowable.appearance-ltr & { left: -1px; right: auto; }
			html.book-reflowable.appearance-ttb & { top: -1px; bottom: auto; }
			html:not(.slider-opened) & { display: none; }
		}
	}
}


// - . Bookmap > Spread Box > Spread > Item Box > Item
// --------------------------------------------------------------------------------

span.bookmap-item {
	/*
	box-sizing: content-box;
	display: block;
	position: absolute;
	z-index: 1;
	@include trbl(0);
	margin: 0;
	padding: 0;
	@include size(100%);
	border: none 0;
	line-height: 1;
	vertical-align: top;
	*/
	display: none;
}


// - . Bookmap > Spread Box > Spread > Item Box > Page
// --------------------------------------------------------------------------------

$Slider-Bookmap-Page_Color_SliderOpened: white;
$Slider-Bookmap-Page_Color_SliderOpened__Hover: lighten(steelblue, 33%);
$Slider-Bookmap-Page_BorderColor_SliderOpened__Hover: $Slider-Bookmap-Page_Color_SliderOpened__Hover;

span.bookmap-page {
	box-sizing: border-box;
	display: block;
	z-index: 10;
	div.bookmap-item-box.reflowable & {
		position: relative;
		flex-shrink: 0;
	}
	div.bookmap-item-box.pre-paginated & {
		position: absolute;
		@include trbl(0);//trbl(-1px);
		margin: auto;
		@include size(100%);
	}
	background: transparent;
	html.slider-opened & {
		background-color: $Slider-Bookmap-Page_Color_SliderOpened;
	}
	html.slider-opened &.hover {
		background-color: $Slider-Bookmap-Page_Color_SliderOpened__Hover;
		border: solid 1px $Slider-Bookmap-Page_BorderColor_SliderOpened__Hover;
	}
	/*
	div.bookmap-item-box:nth-of-type(odd) & { background: red; }
	div.bookmap-item-box:nth-of-type(even) & { background: blue; }
	div.bookmap-item-box:nth-of-type(odd) & { background: blue; }
	div.bookmap-item-box:nth-of-type(even) & { background: red; }
	*/
}


// - . Rail
// --------------------------------------------------------------------------------

$Slider-Rail_Width_SliderOpened: 3px;
$Slider-Rail-Progress_Width_SliderOpened: 3px;
$Slider-Rail_Color:                rgba(gray,      0.250);//rgba($GLOBAL__Scrollbar-Thumb_BackgroundColor, .5);
$Slider-Rail_Color__Hover:          rgba(gray,      0.250);//rgba(steelblue, 0.33);//rgba($GLOBAL__Scrollbar-Thumb_BackgroundColor, .5);
$Slider-Rail-Progress_Color:       rgba(steelblue, 1.000);//rgba($GLOBAL__Scrollbar-Thumb_BackgroundColor, .5);
$Slider-Rail-Progress_Color__Hover: rgba(steelblue, 1.000);//rgba($GLOBAL__Scrollbar-Thumb_BackgroundColor, .5);

div#bibi-slider-rail {
	& {
		content: "";
		//overflow: hidden;
		// display: none; // DO NOT SET `none` !!
		box-sizing: border-box;
		position: absolute;
		z-index: 10000;
		//@include trbl(-100vh, -100vw);
		@include trbl(0);
		margin: auto;
		background: $Slider-Rail_Color;
		pointer-events: none;
		transition: background-color linear .33s;
	}
	div#bibi-slider:hover & {
		background: $Slider-Rail_Color__Hover;
	}
	html.appearance-horizontal & {
		//@include trbl(auto, auto, $GLOBAL__Scrollbar-Track_Size / 2, auto);
		height: 0;
	}
	html.appearance-vertical & {
		//@include trbl(auto, $GLOBAL__Scrollbar-Track_Size / 2, auto, auto);
		width: 0;
	}
	html.slider-opened & {
		border-radius: $Slider-Rail_Width_SliderOpened / 2;
	}
	html.slider-opened.appearance-horizontal & {
		height: $Slider-Rail_Width_SliderOpened;
	}
	html.slider-opened.appearance-vertical & {
		width: $Slider-Rail_Width_SliderOpened;
	}
}

div#bibi-slider-rail-progress {
	& {
		position: absolute;
		@include size(0);
		background: $Slider-Rail-Progress_Color;
		transition: background-color linear .33s;
		will-change: transform;
	}
	div#bibi-slider:hover & {
		background: $Slider-Rail-Progress_Color__Hover;
	}
	html.appearance-horizontal & { top: -100%; bottom: -100%; margin: auto 0;                                        }
	html.appearance-rtl &        {                                             right: 0; transform-origin: 100% 50%; }
	html.appearance-ltr &        {                                             left:  0; transform-origin:   0  50%; }
	html.appearance-vertical &   { left: -100%; right: -100%; margin: 0 auto;  top:   0; transform-origin:  50%  0 ; }
	html.slider-opened & {}
	html.slider-opened.appearance-horizontal & { height: $Slider-Rail-Progress_Width_SliderOpened; }
	html.slider-opened.appearance-vertical   & { width:  $Slider-Rail-Progress_Width_SliderOpened; }
}


// - . Thumb
// --------------------------------------------------------------------------------

$Slider-Thumb-Bar_BorderColor: transparent;
$Slider-Thumb-Bar_Background: $GLOBAL__Scrollbar-Thumb_BackgroundColor;
$Slider-Thumb-Bar_Background__Hover: $GLOBAL__Scrollbar-Thumb_BackgroundColor__Hover;
$Slider-Thumb-Bar_Background__Active: $GLOBAL__Scrollbar-Thumb_BackgroundColor__Active;

$Slider-Thumb-Bar_BorderColor_SliderOpened: rgba(steelblue, .125);
//$Slider-Thumb-Bar_Background_SliderOpened: rgba(white, 0) radial-gradient(circle farthest-side at center, rgba(steelblue, .1), rgba(steelblue, .4));
//$Slider-Thumb-Bar_Background_SliderOpened__Hover: rgba(white, .5) radial-gradient(circle farthest-side at center, rgba(steelblue, .1), rgba(steelblue, .4));
$Slider-Thumb-Bar_Background_SliderOpened: rgba(steelblue, .125);
$Slider-Thumb-Bar_Background_SliderOpened__Hover: rgba(steelblue, .25);
$Slider-Thumb-Bar_Background_SliderOpened__Active: rgba(steelblue, .25);//$Slider-Thumb-Bar_Background_SliderOpened;

$Slider-Thumb-Circle_Background: $GLOBAL__Scrollbar-Thumb_BackgroundColor;//lighten(steelblue, 50%);

$Slider-Thumb-Circle_Size_SliderOpened: $GLOBAL__Scrollbar-Thumb_Size * 2;
$Slider-Thumb-Circle_Background_SliderOpened: steelblue;//lighten(steelblue, 50%);

$Slider-Thumb-Circle_BorderWidth_SliderOpened: 0;//($Slider-Thumb-Circle_Size_SliderOpened - $Slider-Rail_Width_SliderOpened * 1.5) / 2;
$Slider-Thumb-Circle_BorderColor_SliderOpened: transparent;//rgba(steelblue, 1);

$Slider-Thumb-Circle-Halo_Width_SliderOpened: 2px;
$Slider-Thumb-Circle-Halo_Color_SliderOpened: rgba(white, .75);

div#bibi-slider-thumb {
	& {
		display: block;
		box-sizing: border-box;
		position: absolute;
		z-index: 100000;
		margin: auto;
		pointer-events: none;
	}
	html.appearance-horizontal & {
		//top: -100vh;
		//bottom: -100vh;
		top: 0; bottom: 0;
		height: $GLOBAL__Scrollbar-Thumb_Size;
		will-change: width, height, transform, left;
	}
	html.appearance-vertical & {
		//left: -100vw;
		//right: -100vw;
		left: 0; right: 0;
		width: $GLOBAL__Scrollbar-Thumb_Size;
		will-change: width, height, transform, top;
	}
	&.hover {
		background: $Slider-Thumb-Bar_Background__Hover;
	}
	&:active,
	&.active {
		background: $Slider-Thumb-Bar_Background__Active;
	}
	html.slider-opened & {
		border-radius: 1px;//$GLOBAL__Scrollbar-Thumb_Size;
		border-color: transparent;//$Slider-Thumb-Bar_BorderColor_SliderOpened;
		background: transparent;//$Slider-Thumb-Bar_Background_SliderOpened;
	}
	html.slider-opened.appearance-horizontal & {
		height: 100%;
	}
	html.slider-opened.appearance-vertical & {
		width: 100%;
	}
	html.slider-opened &:hover {
		background: transparent;//$Slider-Thumb-Bar_Background_SliderOpened__Hover;
	}
	html.slider-opened &:active,
	html.slider-opened &.active {
		background: transparent;//$Slider-Thumb-Bar_Background_SliderOpened__Active;
	}
	&:before {
		& {
			content: "";
			box-sizing: border-box;
			display: block;
			position: absolute;
			z-index: 10;
			@include trbl($GLOBAL__Scrollbar-Thumb_Size * -1);
			margin: auto;
			@include size(100%);
			border-radius: $GLOBAL__Scrollbar-Thumb_Size * 0.5;
			background: $GLOBAL__Scrollbar-Thumb_BackgroundColor;
			//transform: scale(0);
			transition: $Slider_Transition;
			//pointer-events: auto;
		}
		html.appearance-horizontal & {
			min-width: $GLOBAL__Scrollbar-Thumb_Size;
		}
		html.appearance-vertical & {
			min-height: $GLOBAL__Scrollbar-Thumb_Size;
		}
		html.slider-opened & {
			@include trbl($Slider-Thumb-Circle_Size_SliderOpened * -1);
			@include size($Slider-Thumb-Circle_Size_SliderOpened);
			@include min-size(0);
			border: solid $Slider-Thumb-Circle_BorderWidth_SliderOpened $Slider-Thumb-Circle_BorderColor_SliderOpened;
			border-radius: 50%;
			background: $Slider-Thumb-Circle_Background_SliderOpened;
			box-shadow: 0 0 0 $Slider-Thumb-Circle-Halo_Width_SliderOpened $Slider-Thumb-Circle-Halo_Color_SliderOpened;
		}
		html.slider-opened.appearance-horizontal & { cursor: col-resize; }
		html.slider-opened.appearance-vertical &   { cursor: row-resize; }
	}
}




// ================================================================================
// + Arrows
// --------------------------------------------------------------------------------

$Arrow-Bar_Length: $GLOBAL__TopBar_Height;
$Arrow-Icon_Size: $Arrow-Bar_Length * 1;

div#bibi-arrow-back,
div#bibi-arrow-forward {
	//// Layout
	& {
		display: none; html.arrows-active & { display: block; }
		position: absolute;
		z-index: $GLOBAL__Arrow_ZIndex;
		margin: auto;
		line-height: 1;
		&:before, &:after {
			box-sizing: border-box;
			display: block;
			position: absolute;
		}
		&:before { // icon
			@include font-icon("Material Icons");
			z-index: 2;
			margin: auto;
			@include size($Arrow-Icon_Size);
			text-align: center;
			vertical-align: middle;
			font-size: $Arrow-Icon_Size;
			border-radius: 50%;
			color: white;//rgb(96,96,96);
			background: black;
		}
		&:after { // edge shadow
			content: "";
			z-index: 1;
		}
	}
	html.appearance-horizontal & {
		// ←→
		bottom: auto; width: 0;
		&:before { top: 0; bottom: 0; }
		&:after  { top: 0; bottom: 0; @include size($Arrow-Bar_Length, 100%); }
	}
	html.appearance-horizontal.book-full-height:not(.slider-opened) & {
		top: 0;
		height: 100%; height: 100vh; // overrided by script
	}
	html.appearance-horizontal.book-full-height.slider-opened &,
	html.appearance-horizontal:not(.book-full-height) & {
		top: $GLOBAL__TopBar_Height;
	}
	html.appearance-horizontal:not(.book-full-height):not(.slider-opened) & {
		height: calc(100% - #{$GLOBAL__TopBar_Height}); height: calc(100vh - #{$GLOBAL__TopBar_Height}); // overrided by script
	}
	html.appearance-horizontal.book-full-height.slider-opened &,
	html.appearance-horizontal:not(.book-full-height).slider-opened & {
		height: calc(100% - #{$GLOBAL__TopBar_Height + 78px}); height: calc(100vh - #{$GLOBAL__TopBar_Height + 78px});
	}
	html.appearance-vertical & {
		// ↑↓
		left: 0; right: auto; height: 0;
		&:before { left: 0; right: 0; }
		&:after  { left: 0; right: 0; @include size(100%, $Arrow-Bar_Length); }
	}
	html.appearance-vertical:not(.slider-opened) & {
		width: 100%; width: 100vw; // overrided by script
	}
	html.appearance-vertical.slider-opened & {
		width: calc(100% - 78px); width: calc(100vw - 78px);
	}
	html.busy & {
		&:before, &:after { opacity: 0 !important; transition: none !important; }
	}
	//// Interaction
	& {
		&:before, &:after { transition-duration: .4s; }
		&:before { opacity: 0.00; transform: scale(1.10); transition-timing-function: cubic-bezier(.2, .8, .8, 1.6); }
		&:after  { opacity: 1.00;                         transition-timing-function: ease-out; }
	}
	&.available.hover {
		cursor: pointer;
		&:before, &:after { transition-duration: .2s; }
		&:before { opacity: 1.00; transform: scale(1.10); }
	}
	&.available.active {
		&:before, &:after { transition-duration: .1s; }
		&:before { opacity: 0.75; transform: scale(1.00); }
	}
	&.available.glowing {
		&:before, &:after { transition-duration: .1s; }
		&:before { opacity: 1.00; transform: scale(1.10); }
	}
}

html.appearance-ttb.book-full-height.slider-opened div#bibi-arrow-back,
html.appearance-ttb:not(.book-full-height) div#bibi-arrow-back {
	& {
		&:before { margin-top: $GLOBAL__TopBar_Height; }
	}
}

@mixin arrow-variation($Arrow_Dir, $Arrow_TransformOrigin, $Arrow-Icon_Code, $Arrow-Icon_Code__Glowing, $Arrow-Icon_LineHeight, $Arrow-Icon_Indent) {
	& {
		#{$Arrow_Dir}: 0;
		&:before, &:after { transform-origin: $Arrow_TransformOrigin; }
		&:before { content: $Arrow-Icon_Code; #{$Arrow_Dir}: $GLOBAL__ButtonGroup_Margin; line-height: $Arrow-Icon_LineHeight; text-indent: $Arrow-Icon_Indent; }
		//&:after { #{$Arrow_Dir}: $Arrow-Bar_Length * -1; background: linear-gradient(to $Arrow_Dir, rgba(128,128,128, 0), rgba(128,128,128, 0) 25%, rgba(128,128,128, 0.125)); }
		&:after { #{$Arrow_Dir}: $Arrow-Bar_Length * -1; background: linear-gradient(to $Arrow_Dir, transparent, rgba(black, 0) 25%, rgba(black, 0.1)); }
	}
	&.available.hover, &.available.glowing {
		&:after { #{$Arrow_Dir}: 0; }
	}
	&.available.glowing {
		&:before { content: $Arrow-Icon_Code__Glowing; #{$Arrow_Dir}: 8px; }
	}
}

html.appearance-ltr div#bibi-arrow-back,
html.appearance-rtl div#bibi-arrow-forward {
	/* ← */ @include arrow-variation(  left,   0%  50%, "\e5cb", "\e5cb", $Arrow-Icon_Size, -.03em); // chevron_left
}
html.appearance-ltr div#bibi-arrow-forward,
html.appearance-rtl div#bibi-arrow-back {
	/* → */ @include arrow-variation( right, 100%  50%, "\e5cc", "\e5cc", $Arrow-Icon_Size, .03em); // chevron_right
}

html.appearance-ttb div#bibi-arrow-back {
	/* ↑ */ @include arrow-variation(   top,  50%   0%, "\e5ce", "\e5ce", $Arrow-Icon_Size * .97, 0); // expand_less
}
html.appearance-ttb div#bibi-arrow-forward {
	/* ↓ */ @include arrow-variation(bottom,  50% 100%, "\e5cf", "\e5cf", $Arrow-Icon_Size * 1.03, 0); // expand_more
}




// ================================================================================
// + Spinner
// --------------------------------------------------------------------------------


$Spinner_Size: 56px;
$Spinner-Halo_Size: 32px; $Spinner-halo-color: rgba(192,192,192,0.50);
$Spinner-Core_Size: 24px; $Spinner-core-color: rgba(192,192,192,0.75);
$Spinner_HowManyBits: 12;

div#bibi-spinner {
	box-sizing: border-box;
	display: none;
	position: fixed;
	z-index: $GLOBAL__Spinner_ZIndex;
	@include trbl(48%, -100%, auto);
	margin: auto;
	@include size($Spinner_Size);
	&:before, &:after {
		content: "";
		position: absolute;
		box-sizing: border-box;
		@include trbl(0);
		margin: auto;
		border-radius: 50%;
		opacity: 0.75;
	}
	&:before { // core
		@include size($Spinner-Core_Size);
		background: $Spinner-core-color;
	}
	&:after { // halo
		@include size($Spinner-Halo_Size);
		border: solid 1.5px $Spinner-halo-color;
	}
	span {
		display: block;
		position: absolute;
		@include trbl(0, -100%, auto);
		margin: 0 auto;
		border-radius: 50%;
		@include size(3px);
		transform-origin: 50% ($Spinner_Size * 0.5);
		//background: rgba(128,128,128,0.5);
		@for $i from 1 through $Spinner_HowManyBits {
			&:nth-child(#{$i}) {
				background: darken(rgb(255,255,255), (72% / $Spinner_HowManyBits * $i));
				transform: rotate(360deg / $Spinner_HowManyBits * $i);
			}
		}
	}
	html.busy & {
		display: block;
		animation: SPIN 1.5s linear 0s infinite normal;
		&:before, &:after {
			animation: BEAT 2.25s ease 0s infinite normal;
		}
		span {
			//animation: GLOW 4s ease-in-out 0s infinite normal;
		}
	}
}

@keyframes SPIN {
	  0% { transform: rotate(  0deg); }
	100% { transform: rotate(360deg); }
}

@keyframes BEAT {
	  0% { transform: scale(1.00); opacity: 0.75; }
	 25% { transform: scale(1.25); opacity: 0.50; }
	 50% { transform: scale(1.00); opacity: 0.75; }
	 75% { transform: scale(0.80); opacity: 1.00; }
	100% { transform: scale(1.00); opacity: 0.75; }
}
/*
@keyframes GLOW {
	  0% { @include size(3px     ); opacity: 1.0; }
	 25% { @include size(1px     ); }
	 50% { @include size(1px, 6px); opacity: 1.0; }
	 75% { @include size(1px     ); }
	100% { @include size(3px     ); opacity: 1.0; }
}*/