BiB/i for Pegasus Project
================================================================================================================================

設置ガイド
--------------------------------------------------------------------------------------------------------------------------------

bibフォルダ内の以下のファイル一式を静的なHTTPサーバ上に配置してください。

```
+ bib/
  + bookshelf/
    - lenna.epub
  + i/
    + extensions/*
    + presets/
      - pegasus.js
    + res/
      + fonts/*
      + scripts/*
      + styles/*
    - index.html
  - i.js
```

※`bib/bookshelf/lenna.epub`は動作確認用のサンプルファイルであり、本番環境では不要です。


### サーバの起動

ローカル環境で確認する場合は [serve](https://www.npmjs.com/package/serve) 等をご利用ください。


```sh
$ npx serve -r bib
2019/07/08 17:50:01 serving /Users/lunascape/dev/pegasus/bib as / on :5000
```

以下のようにパラメータを指定してブラウザでURLを開くと、コンテンツの表示を確認できます。

```
http://<静的サーバのホスト>/i/?lsld&book=<ファイル名>&key=<コンテンツ鍵文字列>
```

#### パラメータ

パラメータ名 | 例                                  | 解説 
---------- | ----------------------------------- | -----
lsld       | \<値なし\>                             | 暗号化コンテンツ有効化フラグ
book       | `lenna.epub`                        | `bib/i/presets/pegasus.js` の `bookshelf` で指定したURLを起点とした相対パス
key        | `0123456789abcdef0123456789abcdef`  | `bib/i/presets/pegasus.js` の `bookshelf` で指定したURLを起点とした相対パス


本パッケージにはテスト用コンテンツとして `lenna.epub` が含まれています。
鍵文字列として `0123456789abcdef0123456789abcdef` を指定してブラウザで開くと動作を確認できます。

#### 例）
`http://localhost:5000/i/?lsld&book=lenna.epub&key=0123456789abcdef0123456789abcdef`


コンテンツ配信
--------------------------------------------------------------------------------------------------------------------------------

外部ドメインに設置されたファイルを開く場合は、コンテンツの配信サーバ(CDN等)でcors設定が必要になります。

`bib/i/presets/pegasus.js`にて以下の項目を変更してください。

項目名               | 内容
------------------- | ----
bookshelf           | bookパラメータの基点となるURL
trustworthy-origins | bookパラメータのURLとして許可するオリジン
